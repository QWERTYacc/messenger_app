(this.webpackJsonpmessenger=this.webpackJsonpmessenger||[]).push([[0],{105:function(e,t,a){},110:function(e,t,a){},16:function(e,t,a){e.exports={body:"ProfileCard_body__2QXNj",userPhoto:"ProfileCard_userPhoto__Hka_2",discriptionText:"ProfileCard_discriptionText__Fwqjt",input:"ProfileCard_input__3JDuf"}},18:function(e,t,a){e.exports={body:"DialogsItem_body__SEl4a",userInfo:"DialogsItem_userInfo__2XhTS",userPhoto:"DialogsItem_userPhoto__1wZOk",user_name:"DialogsItem_user_name__3EyqU",newMsgsContainer:"DialogsItem_newMsgsContainer__1yppQ",newMsgs:"DialogsItem_newMsgs__36HlF"}},19:function(e,t,a){e.exports={body:"ContactItem_body__3C_nb",userInfo:"ContactItem_userInfo__3GnzR",userPhoto:"ContactItem_userPhoto__1ZrAL",user_name:"ContactItem_user_name__WFAgm",newMsgsContainer:"ContactItem_newMsgsContainer__1LLPS",newMsgs:"ContactItem_newMsgs__2J5T6"}},204:function(e,t){},209:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a(1),o=a.n(s),r=a(27),c=a.n(r);a(105),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=a(28),l=a(5),d="CHANGE_INPUTS",u="REGISTRATION",g="LOGIN",h={email:"",password:""},p=function(e,t){return{type:u,isLoad:e,newUser:t}},j=function(e,t){return{type:g,token:e,id:t}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d:return Object(l.a)(Object(l.a)({},e),{},{email:t.email,password:t.password});case u:return{email:"",password:"",newUser:t.newUser,isLoad:t.isLoad};case g:return Object(l.a)(Object(l.a)({},e),{},{token:t.token,userId:t.id});default:return e}},b=a(21),f="GET_NEW_MESSAGES",v={newMessages:{}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(l.a)(Object(l.a)({},e),{},{newMessages:Object(l.a)(Object(l.a)({},e.newMessages),{},Object(b.a)({},t.data.dialogId,t.data))});default:return e}},x="UPLOAD_DIALOGS",_="CHECK_NEW_MESSAGES",N="RELOAD_DIALOGS",w={},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(l.a)(Object(l.a)({},e),{},{dialogs:t.data,isLoad:t.isLoad});case _:return e.dialogs&&e.dialogs.forEach((function(e){t.dialogId===e.dialogId&&(e.newMsgs=t.messages.length,e.lastMsg=t.lastMsg)})),t.messages.length>0?Object(l.a)(Object(l.a)({},e),{},{upDialog:t.dialogId}):Object(l.a)(Object(l.a)({},e),{},{upDialog:""});case N:return Object(l.a)(Object(l.a)({},e),{},{isLoad:!1});default:return e}},C="UPDATE_EMAIL",I="GET_NEW_USER",S="REDIRECT_NEW_USER",P={newContact:{email:""}},D=function(e,t,a){return{type:I,data:e,changed:t,isLoad:a}},L=function(e){return{type:S,redirect:e}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return{newContact:{email:t.update},changed:t.changed,isLoad:t.isLoad};case I:return null===t.data&&(t.data={email:""}),{newContact:t.data,changed:t.changed,isLoad:t.isLoad};case S:return!1===t.redirect?{newContact:{email:""}}:{newContact:{email:""},redirect:t.redirect};default:return e}},B="ID_DIALOG",U="UPLOAD_DIALOG",M={currentDialog:null},k={dialogId:"",dialog:{messages:[]}},A=function(e){return{type:B,dialogId:e}},E=function(e){return{type:U,dialog:e}},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return M.currentDialog=t.dialogId,M[t.dialogId]?Object(l.a)(Object(l.a)({},e),{},{dialogId:t.dialogId,dialog:M[t.dialogId],isLoad:!0}):Object(l.a)(Object(l.a)({},e),{},{dialogId:t.dialogId,isLoad:!1});case U:return M[t.dialog.dialogId]=t.dialog,Object(l.a)(Object(l.a)({},e),{},{dialog:M[M.currentDialog],isLoad:!0});default:return e}},R="CHANGE_NEW_MESSAGE",F={newMessage:""},G=function(e){return{type:R,newMessage:e}},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return{newMessage:t.newMessage};default:return e}},W="UPLOAD_CONTACTS",z="RELOAD_CONTACTS",H="CONTACT_CARD",Q={isLoad:!1},X=function(e){return{type:H,contactCard:e}},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return{contacts:t.data,isLoad:!0};case z:return Object(l.a)(Object(l.a)({},e),{},{isLoad:!1});case H:if(null!==t.contactCard.userBirthday&&void 0!==t.contactCard.userBirthday){var a=t.contactCard.userBirthday.split("");t.contactCard.userBirthday=a.slice(0,10).join("")}return Object(l.a)(Object(l.a)({},e),{},{contactCard:t.contactCard});default:return e}},K="GET_USER_DATA",V="CHANGE_USER_DATA",Z="UPDATE_USER_DATA",$="RELOAD_USER_DATA",ee={id:null,changed:!1,changePage:!1},te=function(e){return{type:K,userData:e}},ae=function(e){return{type:V,change:e}},ne=function(e,t,a){return{type:Z,itemName:e,itemValue:t,disabled:a}},se=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case K:var n=null;if(null!==a.userData.userBirthday&&void 0!==a.userData.userBirthday){var s=a.userData.userBirthday.split("");n=s.slice(0,10).join("")}return{id:a.userData.id,userPhoto:a.userData.userPhoto,firstName:a.userData.firstName,lastName:a.userData.lastName,email:a.userData.email,userSex:a.userData.userSex,userBirthday:n,changed:!1,changePage:!1};case V:return Object(l.a)(Object(l.a)({},t),{},{changePage:a.change});case Z:return Object(l.a)(Object(l.a)({},t),{},(e={},Object(b.a)(e,a.itemName,a.itemValue),Object(b.a)(e,"changed",!0),e));case $:return Object(l.a)(Object(l.a)({},t),{},{id:a.id});default:return t}},oe="LOG_OUT",re=Object(i.b)({authPage:m,navBar:O,profilePage:se,dialogsList:y,searchNewUser:T,dialogPage:J,textArea:q,contactsPage:Y}),ce=Object(i.c)((function(e,t){return t.type===oe&&(e=void 0,localStorage.clear()),re(e,t)}));window.store=ce;var ie=ce,le=a(9),de=a(7),ue=(a(110),a(8)),ge=a(30),he=a.n(ge),pe={mainTextColor:"blue-text",mainColor:"blue",navTextColor:"blue-text text-darken-4",accentTextColor:"orange-text text-darken-2",accentColor:"orange darken-2",accentColorFill:"#f57c00"},je=a(57),me=a.n(je),be=a(58),fe=a(4);var ve=function(e){var t=function(t){var a=document.querySelector("#email_inline").value,n=document.querySelector("#password").value;"email"===t.target.name&&(a=t.target.value),"password"===t.target.name&&(n=t.target.value);var s=function(e,t){return{type:d,email:e,password:t}}(a,n);e.dispatch(s)},a=function(t){if("register"===t.target.name){be({method:"post",url:"/api/auth/register",data:e.authState}).then((function(t){var a=p(!1,t.data.userEmail);e.dispatch(a)})).catch((function(e){e=JSON.parse(e.request.response),me.a.toast({html:"".concat(e.message)}),setTimeout((function(){window.location.reload()}),1500)}));var a=p(!0);e.dispatch(a)}"login"===t.target.name&&be({method:"post",url:"/api/auth/login",data:e.authState}).then((function(t){!function(t,a){localStorage.setItem("userData",JSON.stringify({token:t,id:a}));var n=j(t,a);e.dispatch(n)}(t.data.token,t.data.userId)})).catch((function(e){console.log(e.request),e=JSON.parse(e.request.response),me.a.toast({html:"".concat(e.message),completeCallback:function(){window.location.reload()}})}))},s=!0;if(""===e.authState.email&&""===e.authState.password||(s=!1),e.authState.isLoad)return Object(n.jsx)("div",{className:he.a.body,children:Object(n.jsx)(fe.Preloader,{})});var o=function(e){return e?"displayBlock":"noShowItem"};return Object(n.jsx)("div",{className:he.a.body,children:Object(n.jsxs)("div",{className:he.a.container,children:[Object(n.jsx)("h3",{className:pe.mainTextColor,children:"Log In"}),Object(n.jsxs)("h5",{className:o(e.authState.newUser),children:["New user",Object(n.jsx)("br",{}),'"',"".concat(e.authState.newUser),'"',Object(n.jsx)("br",{}),"created.",Object(n.jsx)("br",{}),"You can login"]}),Object(n.jsx)(fe.TextInput,{email:!0,id:"email_inline",label:"Email",name:"email",onChange:t,validate:!0}),Object(n.jsx)(fe.TextInput,{password:!0,id:"password",label:"Password",name:"password",onChange:t}),Object(n.jsxs)("div",{className:he.a.bntsSet,children:[Object(n.jsx)(fe.Button,{className:"".concat(pe.mainColor),name:"login",small:!0,style:{},waves:"light",disabled:s,onClick:a,children:"Login"}),Object(n.jsx)(fe.Button,{className:"".concat(pe.accentColor," ").concat(o(!e.authState.newUser)),name:"register",small:!0,style:{},waves:"light",disabled:s,onClick:a,children:"Registration"})]})]})})},Oe=Object(de.b)((function(e){return{authState:e.authPage}}),(function(e){return{dispatch:function(t){e(t)}}}))(ve),xe=a(91),_e=a.n(xe),Ne=a(92),we=a.n(Ne);var ye=function(e){var t=0;for(var a in e.navBar.newMessages)e.navBar.newMessages[a].messages.length>0&&t++;var s="noShowItem";return t>0&&(s="showItem"),Object(n.jsx)("nav",{className:pe.mainColor,children:Object(n.jsx)("div",{className:"nav-wrapper",children:Object(n.jsxs)("ul",{id:"nav-mobile",className:"".concat(we.a.body," center"),children:[Object(n.jsx)("li",{children:Object(n.jsx)(le.b,{to:"/profile",children:"Profile"})}),Object(n.jsx)("li",{children:Object(n.jsxs)(le.b,{to:"/dialogs",children:["Dialogs",Object(n.jsx)("span",{style:{color:"#FFD073",paddingLeft:"5px"},className:"".concat(s),children:t})]})}),Object(n.jsx)("li",{children:Object(n.jsx)(le.b,{onClick:function(){var t=X(!1);e.dispatch(t)},to:"/contacts",children:"Contacts"})})]})})})},Ce=Object(de.b)((function(e){return{navBar:e.navBar}}),(function(e){return{dispatch:function(t){e(t)}}}))(ye),Ie=a(93),Se=a.n(Ie),Pe=a(61),De=a.n(Pe),Le=a(94),Te=a(22),Be=a.n(Te),Ue=a(16),Me=a.n(Ue);var ke=function(e){function t(){var t=ae(!0);e.dispatch(t)}function a(){var t={type:oe};e.dispatch(t)}function s(){var t=X(!1);e.dispatch(t);var a=A(e.profile.dialogId);e.dispatch(a)}return Object(n.jsxs)("div",{className:Me.a.body,children:[Object(n.jsx)("div",{className:Me.a.userPhoto,style:{backgroundImage:"url(".concat(e.profile.userPhoto,")")}}),Object(n.jsx)("p",{className:Me.a.discriptionText,children:e.profile.firstName}),Object(n.jsx)("p",{className:Me.a.discriptionText,children:e.profile.lastName}),Object(n.jsx)("p",{className:Me.a.discriptionText,children:e.profile.email}),Object(n.jsx)("p",{className:Me.a.discriptionText,children:e.profile.userSex}),Object(n.jsx)("p",{className:Me.a.discriptionText,children:e.profile.userBirthday}),(o=e.btns,o.map((function(e){return"changeBtn"===e.btnFunc&&(e.btnFunc=t),"logoutBtn"===e.btnFunc&&(e.btnFunc=a),"redirectToDialog"===e.btnFunc&&(e.btnFunc=s),Object(n.jsx)("button",{className:"".concat(pe[e.btnStyle]," waves-effect waves-light btn"),name:"change",onClick:e.btnFunc,children:e.btnName},Math.random()*Math.random())})))]});var o};var Ae=function(e){function t(t){var a;a="sex"===t.target.name?ne(t.target.name,t.target.selectedOptions[0].value,!0):ne(t.target.name,t.target.value,!0),e.dispatch(a)}return Object(n.jsxs)("div",{className:Me.a.body,children:[Object(n.jsx)(fe.TextInput,{id:"profileNameInput",label:"First Name",name:"firstName",value:e.profilePage.firstName,onChange:function(e){t(e)}}),Object(n.jsx)(fe.TextInput,{id:"profileLastNameInput",label:"Last Name",name:"lastName",email:!0,value:e.profilePage.lastName,onChange:function(e){t(e)}}),Object(n.jsx)(fe.TextInput,{id:"profileEmailInput",label:"Email",name:"email",value:e.profilePage.email,onChange:function(e){t(e)}}),Object(n.jsxs)(fe.Select,{id:"profileSelect",label:"Sex",name:"userSex",multiple:!1,onChange:function(e){t(e)},defaultValue:e.profilePage.userSex,children:[Object(n.jsx)("option",{disabled:!0,value:"",children:"Check your sex"}),Object(n.jsx)("option",{value:"man",children:"man"}),Object(n.jsx)("option",{value:"woman",children:"woman"})]}),Object(n.jsx)(fe.DatePicker,{id:"profileDatePicker",value:e.profilePage.userBirthday,readOnly:!0,label:"Birthday",name:"userBirthday",onChange:function(){var e=document.querySelector("td.is-selected button"),a=e.dataset.month;(a=Number(a)+1)<10&&(a="0"+a);var n=e.dataset.day;n<10&&(n="0"+Number(n));var s="".concat(e.dataset.year,"-").concat(a,"-").concat(n),o={target:{}};o.target.name="userBirthday",o.target.value=s,t(o)},options:{format:"yyyy-mm-dd",yearRange:99}}),Object(n.jsx)(fe.Button,{id:"saveBtn",className:"blue",disabled:!e.profilePage.changed,onClick:function(){var t={id:e.profilePage.id,firstName:e.profilePage.firstName,lastName:e.profilePage.lastName,email:e.profilePage.email,userBirthday:e.profilePage.userBirthday,userSex:e.profilePage.userSex,changed:!0};At.emit("profileData",t);var a={type:$,id:null};e.dispatch(a)},children:"Save"})]})};var Ee=function(e){var t=JSON.parse(localStorage.getItem("userData")).id,a={id:t};return At.on("".concat(t,"Profile"),function(){var t=Object(Le.a)(De.a.mark((function t(a){var n;return De.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=te(a),e.dispatch(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),null===e.profilePage.id?(At.emit("profileData",a),Object(n.jsx)("div",{className:Be.a.body,children:Object(n.jsx)(fe.Preloader,{})})):!0===e.profilePage.changePage?Object(n.jsx)("div",{className:Be.a.container,children:Object(n.jsxs)("div",{className:Be.a.body,children:[Object(n.jsx)(fe.Button,{className:"".concat(Be.a.closeBtn," grey"),floating:!0,icon:Object(n.jsx)(fe.Icon,{children:"close"}),small:!0,waves:"light",onClick:function(){var t=ae(!1);e.dispatch(t)}}),Object(n.jsx)(Ae,{profilePage:e.profilePage,dispatch:e.dispatch})]})}):Object(n.jsx)("div",{className:Be.a.container,children:Object(n.jsx)("div",{className:Be.a.body,children:Object(n.jsx)(ke,{btns:[{btnFunc:"changeBtn",btnStyle:"mainColor",btnName:"Change"},{btnFunc:"logoutBtn",btnStyle:"accentColor",btnName:"Logout"}],profile:e.profilePage,dispatch:e.dispatch})})})},Je=Object(de.b)((function(e){return{profilePage:e.profilePage}}),(function(e){return{dispatch:function(t){e(t)}}}))(Ee),Re=a(95),Fe=a.n(Re),Ge=a(18),qe=a.n(Ge);var We=function(e){var t="noShowItem";return e.data.newMsgs&&e.data.newMsgs>0&&(t="showItem"),Object(n.jsxs)("div",{className:qe.a.body,children:[Object(n.jsxs)("div",{className:qe.a.userInfo,children:[Object(n.jsx)("div",{className:qe.a.userPhoto,style:{backgroundImage:"url(".concat(e.data.photo,")")}}),Object(n.jsx)("div",{className:"".concat(qe.a.user_name," ").concat(pe.navTextColor),children:e.data.name}),Object(n.jsx)("div",{className:"".concat(qe.a.user_name," ").concat(pe.navTextColor),children:e.data.lastName})]}),Object(n.jsx)("div",{className:qe.a.newMsgsContainer,children:Object(n.jsx)("div",{className:"".concat(t," ").concat(qe.a.newMsgs," ").concat(pe.accentTextColor),children:e.data.newMsgs})})]})},ze=a(31),He=a.n(ze);var Qe=function(e){return Object(n.jsxs)("svg",{className:"icon-add",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",version:"1.1",id:"layer_1",x:"0px",y:"0px",viewBox:"0 0 150 150",enableBackground:"new 0 0 150 150",xmlSpace:"preserve",width:e.width,fill:e.fill,children:[Object(n.jsx)("path",{xmlns:"http://www.w3.org/2000/svg",d:"M112.5,72.5h-35v-35c0-1.4-1.1-2.5-2.5-2.5l0,0c-1.4,0-2.5,1.1-2.5,2.5v35h-35c-1.4,0-2.5,1.1-2.5,2.5l0,0  c0,1.4,1.1,2.5,2.5,2.5h35v35c0,1.4,1.1,2.5,2.5,2.5l0,0c1.4,0,2.5-1.1,2.5-2.5v-35h35c1.4,0,2.5-1.1,2.5-2.5l0,0  C115,73.6,113.9,72.5,112.5,72.5z"}),Object(n.jsx)("path",{xmlns:"http://www.w3.org/2000/svg",d:"M75.8,141.8c-37.5,0-68-30.5-68-68s30.5-68,68-68s68,30.5,68,68S113.3,141.8,75.8,141.8z M75.8,10.8c-34.7,0-63,28.3-63,63  s28.3,63,63,63s63-28.3,63-63S110.6,10.8,75.8,10.8z"})]})},Xe=function(e,t,a){if(void 0!==e){if(""!==t){var s=[];e.forEach((function(e){e.lastMsg&&s.push(e.lastMsg)})),s.sort((function(e,t){return e-t})),s.forEach((function(t){e.find((function(e,a,n){return e.lastMsg===t&&(n.splice(a,1),n.unshift(e)),this}))}))}return e.map((function(e){return Object(n.jsx)(le.b,{exact:!0,to:"/dialogs/dialog/".concat(e.dialogId),onClick:function(){var t=A(e.dialogId);a(t)},children:Object(n.jsx)(We,{data:e})},e.dialogId)}))}};var Ye=function(e){if(!e.dialogsList.isLoad){At.emit("dialogList",JSON.parse(localStorage.getItem("userData")).id);var t=JSON.parse(localStorage.getItem("userData")).id,a=0;return void 0!==e.dialogsList.dialogs&&(a=e.dialogsList.dialogs.length),At.emit("updateDialogsList",t,a),At.on("updateDialogsList".concat(t),(function(t){var a=function(e,t){return{type:x,isLoad:e,data:t}}(!0,t);e.dispatch(a)})),Object(n.jsx)("div",{className:He.a.preloaderContainer,children:Object(n.jsx)(fe.Preloader,{})})}if(0===e.dialogsList.dialogs.length)return Object(n.jsxs)("div",{className:He.a.preloaderContainer,children:[Object(n.jsx)("h5",{children:"no dialogs"}),Object(n.jsx)(le.b,{exact:!0,to:"/dialogs/add_new_user",children:Object(n.jsx)(Qe,{width:"50px",fill:pe.accentColorFill})})]});var s="";return e.dialogsList.upDialog&&(s=e.dialogsList.upDialog),Object(n.jsxs)("div",{className:He.a.body,children:[Object(n.jsx)("div",{className:He.a.content,children:Xe(e.dialogsList.dialogs,s,e.dispatch)}),Object(n.jsx)(le.b,{exact:!0,to:"/dialogs/add_new_user",children:Object(n.jsx)(Qe,{width:"50px",fill:pe.accentColorFill})})]})},Ke=Object(de.b)((function(e){return{dialogsList:e.dialogsList}}),(function(e){return{dispatch:function(t){e(t)}}}))(Ye),Ve=a(40),Ze=a(41),$e=a(43),et=a(42),tt=a(44),at=a.n(tt),nt=function(e,t,a,n){e(function(e,t,a){return{type:C,update:e,changed:t,isLoad:a}}(t,a,n))},st=function(e){Object($e.a)(a,e);var t=Object(et.a)(a);function a(){return Object(Ve.a)(this,a),t.apply(this,arguments)}return Object(Ze.a)(a,[{key:"render",value:function(){var e=this;if(this.props.searchNewUser.redirect){var t=A(this.props.searchNewUser.redirect);return this.props.dispatch(t),Object(n.jsx)(ue.a,{to:"/dialogs/dialog/".concat(this.props.searchNewUser.redirect)})}var a,s,o=function(e){return""===e?Object(n.jsx)("div",{className:"noShowItem",children:e}):Object(n.jsx)("div",{className:"displayBlock",children:e})},r="noShowItem",c=!1;return"loading"===this.props.searchNewUser.isLoad&&(r="displayBlock",c=!0,a=Object(n.jsx)(fe.Preloader,{})),!0===this.props.searchNewUser.isLoad&&""===this.props.searchNewUser.newContact.email&&(r="displayBlock",a=Object(n.jsx)(fe.Card,{actions:[Object(n.jsx)(fe.Button,{small:!0,style:{marginTop:0},className:pe.mainColor,onClick:function(){return nt(e.props.dispatch,"",!1,!1)},children:"Close"},"close")],children:"User is not found"})),this.props.searchNewUser.isLoad&&""!==this.props.searchNewUser.newContact.email&&(r="displayBlock",a=Object(n.jsxs)(fe.Card,{style:{maxWidth:"300px"},actions:[Object(n.jsx)(fe.Button,{small:!0,style:{marginTop:0},className:pe.mainColor,onClick:function(){return nt(e.props.dispatch,"",!1,!1)},children:"Close"},"close"),(s=this.props.searchNewUser.newContact.isContact,s?Object(n.jsx)(fe.Button,{small:!0,style:{marginTop:0,marginLeft:"30px"},className:pe.accentColor,onClick:function(){var t=L(e.props.searchNewUser.newContact.dialogId);e.props.dispatch(t)},children:"Go to dialog"},"goToDialog"):Object(n.jsx)(fe.Button,{small:!0,style:{marginTop:0,marginLeft:"30px"},className:pe.accentColor,onClick:function(){At.emit("addNewContact",{userId:JSON.parse(localStorage.getItem("userData")).id,newContactId:e.props.searchNewUser.newContact.id}),nt(e.props.dispatch,"",!1,"loading")},children:"Save"},"save"))],header:Object(n.jsx)(fe.CardTitle,{style:{width:"100%"},image:this.props.searchNewUser.newContact.userPhoto}),children:[o(this.props.searchNewUser.newContact.firstName),o(this.props.searchNewUser.newContact.lastName),this.props.searchNewUser.newContact.email]})),Object(n.jsx)("div",{className:at.a.body,children:Object(n.jsxs)("div",{className:at.a.container,children:[Object(n.jsx)("h5",{className:pe.navTextColor,style:{marginBottom:"30px"},children:"To search for a user enter his (her) e-mail"}),Object(n.jsx)(fe.TextInput,{id:"searchNewUserEmailInput",label:"Email",name:"email",value:this.props.searchNewUser.newContact.email,disabled:c,onChange:function(t){var a=!0;""===t.target.value&&(a=!1),nt(e.props.dispatch,t.target.value,a,!1)}}),Object(n.jsx)(fe.Button,{id:"searchBtn",className:"blue",disabled:!this.props.searchNewUser.changed,onClick:function(){At.emit("findUser",{userId:JSON.parse(localStorage.getItem("userData")).id,contactEmail:e.props.searchNewUser.newContact.email}),nt(e.props.dispatch,"",!1);var t=D({email:""},!1,"loading");e.props.dispatch(t)},children:"Search"}),Object(n.jsx)("div",{className:"".concat(at.a.searchResult," ").concat(r),children:a})]})})}},{key:"componentWillUnmount",value:function(){var e=L(!1);this.props.dispatch(e)}}]),a}(o.a.Component),ot=Object(de.b)((function(e){return{searchNewUser:e.searchNewUser}}),(function(e){return{dispatch:function(t){e(t)}}}))(st);var rt=function(e){return At.on("newContact",(function(t){var a=D(t,!1,!0);e.dispatch(a)})),Object(n.jsx)(ot,{})},ct=a(96),it=a.n(ct),lt=a(45),dt=a.n(lt),ut=a(23),gt=a.n(ut);var ht=function(e){var t,a;return t=""!==e.user.firstName?e.user.firstName:e.user.email,e.user.id===JSON.parse(localStorage.getItem("userData")).id&&(a=gt.a.fromUser,t="You"),e.user.id!==JSON.parse(localStorage.getItem("userData")).id&&(a=gt.a.fromInterlocutor),"system_message"===e.description&&(a=gt.a.fromSystem),Object(n.jsxs)("div",{className:"".concat(gt.a.body," ").concat(a),children:[Object(n.jsx)("div",{className:"".concat(gt.a.sender," ").concat(pe.navTextColor),children:t}),Object(n.jsx)("div",{className:gt.a.messageBody,children:e.messageBody})]})};function pt(e){if(e.isLoad){var t=[];return e.dialog.messages.map((function(a){return a.to===e.dialog.user1.id?t.push(Object(n.jsx)(ht,{to:a.to,messageBody:a.messageBody,user:e.dialog.user2,creation:a.creation,description:a.description},Math.random())):t.push(Object(n.jsx)(ht,{to:a.to,messageBody:a.messageBody,user:e.dialog.user1,creation:a.creation,description:a.description},Math.random()))})),t}}var jt=function(e){Object($e.a)(a,e);var t=Object(et.a)(a);function a(){return Object(Ve.a)(this,a),t.apply(this,arguments)}return Object(Ze.a)(a,[{key:"render",value:function(){if(!this.props.dialogPage.isLoad)return At.emit("uploadDialog",{dialogId:this.props.dialogPage.dialogId,getDialog:!0}),Object(n.jsx)("div",{className:dt.a.preloaderContainer,children:Object(n.jsx)(fe.Preloader,{})});var e=JSON.parse(localStorage.getItem("userData")).id,t=[];return this.props.dialogPage.dialog.messages.length>0&&this.props.dialogPage.dialog.messages.map((function(a){return a.to!==e||a.delivered||t.push(a._id),a})),t.length>0&&At.emit("uploadDialog",{dialogId:this.props.dialogPage.dialogId,userId:e,newDeliveredMessagesIdArr:t}),Object(n.jsx)("div",{className:dt.a.body,id:"dialogArea",children:Object(n.jsx)("div",{className:dt.a.content,onScroll:function(e){console.log(e)},children:pt(this.props.dialogPage)})})}},{key:"componentDidMount",value:function(){if(this.props.dialogPage.isLoad&&this.props.dialogPage.dialog.messages&&this.props.dialogPage.dialog.messages.length>0){var e=document.querySelector("#dialogArea");e.scrollTop=e.scrollHeight}}},{key:"componentDidUpdate",value:function(){var e=document.querySelector("#dialogArea");e.scrollTop=e.scrollHeight}},{key:"componentWillUnmount",value:function(){M.currentDialog=null;var e=A("");this.props.dispatch(e)}}]),a}(o.a.Component),mt=Object(de.b)((function(e){return{dialogPage:e.dialogPage}}),(function(e){return{dispatch:function(t){e(t)}}}))(jt),bt=a(97),ft=a.n(bt);var vt=function(e){var t,a=JSON.parse(localStorage.getItem("userData")).id;e.dialog&&e.dialog.user1&&(t=e.dialog.user1.id!==a?e.dialog.user1.id:e.dialog.user2.id);var s=!0;return""!==e.textArea.newMessage&&(s=!1),Object(n.jsxs)("div",{className:"".concat(ft.a.body," ").concat(pe.mainColor),children:[Object(n.jsx)(fe.Textarea,{className:"white",value:e.textArea.newMessage,id:"dialogTextArea",onChange:function(t){var a=G(t.target.value);e.dispatch(a)}}),Object(n.jsx)(fe.Button,{className:pe.accentColor,node:"button",type:"submit",waves:"light",disabled:s,onClick:function(){At.emit("uploadDialog",{dialogId:e.dialog.dialogId,user:a,interlocutor:t,messageBody:e.textArea.newMessage,creation:Date.now()});var n=G("");e.dispatch(n)},children:Object(n.jsx)(fe.Icon,{children:"send"})})]})},Ot=Object(de.b)((function(e){return{textArea:e.textArea,dialog:e.dialogPage.dialog}}),(function(e){return{dispatch:function(t){e(t)}}}))(vt);var xt=function(){return Object(n.jsxs)("div",{className:it.a.body,children:[Object(n.jsx)(Ot,{}),Object(n.jsx)(mt,{})]})};var _t=function(e){return Object(n.jsxs)("div",{className:Fe.a.body,children:[Object(n.jsx)(ue.b,{exact:!0,path:"/dialogs",render:function(){return Object(n.jsx)(Ke,{})}}),Object(n.jsx)(ue.b,{path:"/dialogs/dialog",render:function(){return Object(n.jsx)(xt,{})}}),Object(n.jsx)(ue.b,{path:"/dialogs/add_new_user",render:function(){return Object(n.jsx)(rt,{dispatch:e.dispatch})}})]})},Nt=a(26),wt=a.n(Nt),yt=a(19),Ct=a.n(yt);var It=function(e){var t,a;return""===e.data.firstName?(t=e.data.email,a=""):(t=e.data.firstName,a=e.data.lastName),Object(n.jsxs)("div",{className:Ct.a.body,children:[Object(n.jsxs)("div",{className:Ct.a.userInfo,children:[Object(n.jsx)("div",{className:Ct.a.userPhoto,style:{backgroundImage:"url(".concat(e.data.userPhoto,")")}}),Object(n.jsx)("div",{className:"".concat(Ct.a.user_name," ").concat(pe.navTextColor),children:t}),Object(n.jsx)("div",{className:"".concat(Ct.a.user_name," ").concat(pe.navTextColor),children:a})]}),Object(n.jsx)("div",{className:Ct.a.newMsgsContainer,children:Object(n.jsx)("div",{className:"".concat("noShowItem"," ").concat(Ct.a.newMsgs," ").concat(pe.accentTextColor),children:e.data.newMsgs})})]})},St=function(e,t){var a=[],s=[];e.forEach((function(e){""!==e.firstName?s.push(e.firstName):a.push(e.email)})),a.sort(),s.sort();var o=a.map((function(t){return e.forEach((function(e){e.email===t&&(t=e)})),t})),r=s.map((function(t){return e.forEach((function(e){e.firstName===t&&(t=e)})),t}));return[].concat(o,r).map((function(e){return Object(n.jsx)(le.b,{exact:!0,to:"/contacts/contact/".concat(e.id),onClick:function(){var a=X(e);t(a)},children:Object(n.jsx)(It,{data:e})},e.id)}))};var Pt=function(e){return e.contactsPage.isLoad?0===e.contactsPage.contacts.length?Object(n.jsx)("div",{className:wt.a.preloaderContainer,children:Object(n.jsx)("h5",{children:"no contacts"})}):e.contactsPage.contactCard?Object(n.jsx)("div",{className:wt.a.preloaderContainer,children:Object(n.jsx)(ke,{btns:[{btnFunc:"redirectToDialog",btnStyle:"accentColor",btnName:"Go to dialog"}],profile:e.contactsPage.contactCard,dispatch:e.dispatch})}):Object(n.jsx)("div",{className:wt.a.body,children:Object(n.jsx)("div",{className:wt.a.content,children:St(e.contactsPage.contacts,e.dispatch)})}):(At.emit("uploadContacts",{userId:JSON.parse(localStorage.getItem("userData")).id}),Object(n.jsx)("div",{className:wt.a.preloaderContainer,children:Object(n.jsx)(fe.Preloader,{})}))},Dt=Object(de.b)((function(e){return{contactsPage:e.contactsPage}}),(function(e){return{dispatch:function(t){e(t)}}}))(Pt),Lt=a(98),Tt=a.n(Lt);var Bt=function(e){return At.on("uploadContacts",(function(t){var a=function(e){return{type:W,data:e}}(t.contactsArr);e.dispatch(a)})),Object(n.jsx)("div",{className:Tt.a.body,children:Object(n.jsx)(ue.b,{path:"/contacts",render:function(){return Object(n.jsx)(Dt,{})}})})};var Ut=function(e){var t,a=JSON.parse(localStorage.getItem("userData")).id;return At.emit("isOnline",{userId:a,isDialogsLoad:e.isDialogsLoad}),Object(n.jsxs)("div",{className:Se.a.body,children:[Object(n.jsx)(ue.b,{path:"/profile",render:function(){return Object(n.jsx)(Je,{})}}),Object(n.jsx)(ue.b,{path:"/dialogs",render:function(){return Object(n.jsx)(_t,{dispatch:e.dispatch})}}),Object(n.jsx)(ue.b,{path:"/contacts",render:function(){return Object(n.jsx)(Bt,{dispatch:e.dispatch})}}),(t=e.dialogId,""!==t&&void 0!==t?Object(n.jsx)(ue.a,{to:"/dialogs/dialog/".concat(t)}):null)]})},Mt=Object(de.b)((function(e){return{dialogId:e.dialogPage.dialogId,isDialogsLoad:e.dialogsList.isLoad}}),(function(e){return{dispatch:function(t){e(t)}}}))(Ut),kt=a(99),At=a.n(kt).a.connect("development"==="production"?"http://localhost:5000":"https://simple--messenger.herokuapp.com");var Et=function(e){var t=JSON.parse(localStorage.getItem("userData")).id;return At.on("getDialog",(function(t){var a=E(t);e.dispatch(a)})),At.on("newMessageTo".concat(t),(function(a){var n=E(a);e.dispatch(n);var s=[];a.dialogId!==M.currentDialog&&a.messages.map((function(e){return e.delivered||e.to!==t||s.push(e),e}));var o={dialogId:a.dialogId,messages:s,lastMsg:a.messages[a.messages.length-1].creation},r=function(e){return{type:f,data:e}}(o);e.dispatch(r);var c={type:_,dialogId:o.dialogId,messages:o.messages,lastMsg:o.lastMsg};e.dispatch(c)})),At.on("addNewContact".concat(t),(function(a){var n={type:z};if(e.dispatch(n),At.emit("updateDialogsList",JSON.parse(localStorage.getItem("userData")).id),a.initiator===t){var s=L(a.newContact.dialogId);e.dispatch(s)}if(a.initiator!==t){var o={type:N};e.dispatch(o)}})),Object(n.jsxs)("div",{className:_e.a.body,children:[Object(n.jsx)(Ce,{}),Object(n.jsx)(Mt,{})]})},Jt=Object(de.b)((function(e){return{}}),(function(e){return{dispatch:function(t){e(t)}}}))(Et);var Rt=function(e){var t=!!e.authState.token;if(void 0!==localStorage.userData&&!1===t){var a=JSON.parse(localStorage.userData),s=j(a.token,a.id);e.dispatch(s)}var o=function(e){return e?Object(n.jsxs)(ue.d,{children:[Object(n.jsx)(ue.b,{path:"/profile",render:function(){return Object(n.jsx)(Jt,{})}}),Object(n.jsx)(ue.b,{path:"/dialogs",render:function(){return Object(n.jsx)(Jt,{})}}),Object(n.jsx)(ue.b,{path:"/contacts",render:function(){return Object(n.jsx)(Jt,{})}}),Object(n.jsx)(ue.a,{to:"/dialogs"})]}):Object(n.jsxs)(ue.d,{children:[Object(n.jsx)(ue.b,{exact:!0,path:"/",render:function(){return Object(n.jsx)(Oe,{})}}),Object(n.jsx)(ue.a,{to:"/"})]})}(t);return Object(n.jsx)("div",{className:"App",children:o})},Ft=Object(de.b)((function(e){return{authState:e.authPage}}),(function(e){return{dispatch:function(t){e(t)}}}))(Rt);c.a.render(Object(n.jsx)(le.a,{children:Object(n.jsx)(de.a,{store:ie,children:Object(n.jsx)(Ft,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},22:function(e,t,a){e.exports={container:"ProfilePage_container__2YxQl",body:"ProfilePage_body__pUQNv",closeBtn:"ProfilePage_closeBtn__X-Ux8"}},23:function(e,t,a){e.exports={body:"MessageItem_body__2DKle",sender:"MessageItem_sender__3lgnW",fromUser:"MessageItem_fromUser__3uPRb",fromInterlocutor:"MessageItem_fromInterlocutor__1O6cK",messageBody:"MessageItem_messageBody__1vPRc",fromSystem:"MessageItem_fromSystem__3QYG6"}},26:function(e,t,a){e.exports={body:"ContactsList_body__ji0bU",content:"ContactsList_content__2otnV",preloaderContainer:"ContactsList_preloaderContainer__wJLwh"}},30:function(e,t,a){e.exports={body:"AuthPage_body__UKA5d",container:"AuthPage_container__1ErkF",bntsSet:"AuthPage_bntsSet__2qiu5"}},31:function(e,t,a){e.exports={body:"DialogsList_body__o4bAz",content:"DialogsList_content__UFbrw",preloaderContainer:"DialogsList_preloaderContainer__1KmdS"}},44:function(e,t,a){e.exports={body:"SearchNewUser_body__3qZak",container:"SearchNewUser_container__3YEpz",searchResult:"SearchNewUser_searchResult__2vN1J"}},45:function(e,t,a){e.exports={body:"DialogBody_body__1ISCj",content:"DialogBody_content__2JXWN",preloaderContainer:"DialogBody_preloaderContainer__Qi1LQ"}},91:function(e,t,a){e.exports={body:"WorkPlace_body__2tSNu"}},92:function(e,t,a){e.exports={body:"Navbar_body__czvJ0"}},93:function(e,t,a){e.exports={body:"AppPages_body__2zqND"}},95:function(e,t,a){e.exports={body:"DialogsPage_body__1Btte"}},96:function(e,t,a){e.exports={body:"Dialog_body__1o6qv",preloaderContainer:"Dialog_preloaderContainer__3ej52"}},97:function(e,t,a){e.exports={body:"TextArea_body__Se-37"}},98:function(e,t,a){e.exports={body:"ContactsPage_body__370XY"}}},[[209,1,2]]]);
//# sourceMappingURL=main.db2c16ad.chunk.js.map